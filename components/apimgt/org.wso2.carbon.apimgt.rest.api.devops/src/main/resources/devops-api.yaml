#   Copyright (c) 2023, WSO2 LLC. (http://www.wso2.com) All Rights Reserved.
#
#   WSO2 LLC. licenses this file to you under the Apache License,
#   Version 2.0 (the "License"); you may not use this file except
#   in compliance with the License.
#   You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
#   Unless required by applicable law or agreed to in writing,
#   software distributed under the License is distributed on an
#   "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#   KIND, either express or implied.  See the License for the
#   specific language governing permissions and limitations
#   under the License.
#
################################################################################
openapi: 3.0.1
info:
  version: v0.1
  title: WSO2 API Manager - DevOps
  description: |
    This document specifies a **RESTful API** for WSO2 **API Manager** - DevOps.
  contact:
    name: WSO2
    url: http://wso2.com/products/api-manager/
    email: architecture@wso2.com
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
paths:
  "/config/correlation/":
    get:
      summary: |
        GET status of correlation log components

      responses:
        "200":
          description: Status of Correlation Log Components
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CorrelationComponentsList"
        "404":
          description: |
            Not Found.
            Request component not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error while retrieving info
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      summary: |
        Enable / Disable correlation logs
      description: >
        This operation enables you to enable / disable correlation logs 
        of the product. This operation can be done at the product level 
        or at each component level by providing the componentName query
        parameter.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CorrelationComponentsList"
        description: |
          The enable / disable correlation log status is provided as a payload.
      responses:
        "200":
          description: Successfully Set the status of the correlation logs.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CorrelationComponentsList"
        "404":
          description: |
            Not Found.
            Request components not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error while configuring the correlation log status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

servers:
  - url: https://apis.wso2.com/api/am/devops/v0

components:
  schemas:
    CorrelationComponentsList:
      title: correlation-components
      properties:
        components:
          type: array
          items:
            $ref: "#/components/schemas/CorrelationComponent"
    CorrelationComponent:
      title: Correlation Component INFO object
      properties:
        name:
          type: string
          example: http
        enabled:
          type: string
          example: true
        properties:
          type: array
          items:
            $ref: "#/components/schemas/CorrelationComponentProperty"

    CorrelationComponentProperty:
      title: Properties for correlation components
      properties:
        name:
          type: string
          example: "deniedThreads"
        value:
          type: array
          items:
            type: string
            example: "MessageDeliveryTaskPool"

    Error:
      title: Error object returned with 4XX HTTP Status
      required:
        - code
        - message
      properties:
        code:
          type: integer
          format: int64
        message:
          type: string
          description: Error message.
        description:
          type: string
          description: |
            A detail description about the error message.
        moreInfo:
          type: string
          description: |
            Preferably an url with more details about the error.
        error:
          type: array
          description: |
            If there are more than one error list them out.
            For example, list out validation errors by each field.
          items:
            $ref: "#/components/schemas/ErrorListItem"
    ErrorListItem:
      title: Description of individual errors that may have occurred during a request.
      required:
        - code
        - message
      properties:
        code:
          type: string
        message:
          type: string
          description: |
            Description about individual errors occurred
        description:
          type: string
          description: |
            A detail description about the error message.